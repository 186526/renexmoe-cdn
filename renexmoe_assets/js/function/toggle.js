import e from"../lib/mdui.js";import{refresh as c,logout as r,Login as s,GetAllLinks as d}from"../utils.js";import{click as u}from"./checkupdate.js";import{ToggleListener as o}from"./menu.js";import n from"../Lang/index.js";const i=e.$;export default()=>{i("#toggle-drawer").on("click",()=>{new e.Drawer("#main-drawer",{swipe:!0}).toggle()}),i(".downloadurl").each((a,t)=>{t.addEventListener("click",()=>{o(),new e.dialog({content:`<div class="mdui-textfield mdui-textfield-floating-label mdui-textfield-not-empty mdui-textfield-disabled"><label class="mdui-textfield-label">URL</label><input class="mdui-textfield-input" type="email" value="${location.href.replace("?preview","")}" id="url-input" disabled=""></div>`,title:"File URL",buttons:[{text:"\u786E\u5B9A",onClick:()=>{o()}}]}),e.mutation()})}),i(".back").each((a,t)=>{t.addEventListener("click",()=>{window.history.back()})}),i(".back-page").each((a,t)=>{t.addEventListener("click",()=>{globalThis.renexmoe.pjax.loadUrl("../")})}),i(".refresh").each((a,t)=>{t.addEventListener("click",()=>{e.snackbar("\u5237\u65B0\u7F13\u5B58\u4E2D\u2026\u2026"),c(location.href).then(l=>{if(l)e.snackbar("\u5DF2\u6210\u529F\u5237\u65B0\u7F13\u5B58"),window.renexmoe.pjax.loadUrl(location.href);else throw e.snackbar("\u5237\u65B0\u7F13\u5B58\u9047\u5230\u672A\u77E5\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u662F\u5426\u5728\u76D8\u7B26\u76EE\u5F55\u9875\u9762"),response})})}),i(".getalllink").each((a,t)=>t.addEventListener("click",()=>{o(),e.dialog({content:`<div class="mdui-typo"><pre>${d(document.querySelector("#file-list"))}</pre>`,title:"\u5168\u90E8\u94FE\u63A5",buttons:[{text:"\u786E\u5B9A",onClick:()=>o()}]})})),i("#logout").on("click",()=>{e.snackbar("\u5C1D\u8BD5\u9000\u51FA\u767B\u9646\u2026\u2026"),r()}),i("#login_btn").on("click",async()=>{const a=document.querySelector("input[name=password1]").value;document.querySelector("#login_close").click(),e.snackbar("\u6B63\u5728\u767B\u9646\u2026\u2026");const t=await s(a);t.status?(e.snackbar(n(t.msg)),window.location.reload()):e.dialog({title:"Login Failed",content:n(t.msg),buttons:[{text:"OK",onClick:l=>{l.close(),document.querySelector("li[mdui-dialog]").click()}}]})})};const m=()=>{i("#about_theme").on("click",()=>{new e.alert('<div class="mdui-typo"><a href="https://github.com/186526/onemanager-theme-renexmoe">Onemanager-theme-renexmoe</a><br>Open source under GPL-3.0 License<br>Build with Love & MDUI & Gulp & snowpack | webpack<br>Author:<a href="https://186526.xyz">186526</a></div>',"\u5173\u4E8Erenexmoe"),e.mutation()}),i("#checkupdate").on("click",()=>{u()})};export{m as drawertoggle};
