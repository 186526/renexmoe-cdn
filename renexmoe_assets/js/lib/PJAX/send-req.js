var updateQueryString=require("pjax/lib/util/update-query-string");module.exports=function(t,r,u){r=r||{};var n,q=r.requestOptions||{},d=(q.requestMethod||"GET").toUpperCase(),f=q.requestParams||null,i=q.formData||null,s=null,e=new XMLHttpRequest,l=r.timeout||0;if(e.onreadystatechange=function(){e.readyState===4&&(e.status===200?u(e.responseText,e,t,r):e.status!==0&&u(null,e,t,r))},e.onerror=function(a){console.log(a),u(null,e,t,r)},e.ontimeout=function(){u(null,e,t,r)},f&&f.length)switch(n=f.map(function(a){return a.name+"="+a.value}).join("&"),d){case"GET":t=t.split("?")[0],t+="?"+n;break;case"POST":s=n;break}else i&&(s=i);return r.cacheBust&&(t=updateQueryString(t,"t",Date.now())),e.open(d,t,!0),e.timeout=l,e.setRequestHeader("X-Requested-With","PJAX_MODIFY"),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Selectors",JSON.stringify(r.selectors)),s&&d==="POST"&&!i&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(s),e};
